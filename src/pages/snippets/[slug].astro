---
import H1 from '@components/atoms/H1.astro'
import { getCollection, type CollectionEntry, getEntry } from 'astro:content'
import RevisedLayout from '@layouts/RevisedLayout.astro'
import { Icon } from 'astro-icon/components'

export async function getStaticPaths() {
	const snippets = await getCollection('snippets')
	return snippets.map((snippet) => ({
		params: { slug: snippet.slug },
		props: { snippet }
	}))
}

interface Props {
	snippet: CollectionEntry<'snippets'>
}

const { snippet } = Astro.props
const { Content } = await snippet.render()
const category = await getEntry(snippet.data.category)
---

<RevisedLayout title={snippet.data.title}>
	<article data-type="web" class="space-y-4">
		<header class="space-y-4" transition:name={snippet.data.title}>
			<div class="relative h-28 rounded-md bg-category p-4">
				<Icon name={category.data.icon} class="absolute bottom-0 left-4 top-20 text-5xl" />
			</div>

			<h1 class="font-heading font-bold tracking-wide [text-wrap:balance]">
				<span>{snippet.data.title}</span>
			</h1>
		</header>

		<article>
			<Content components={{ h1: H1 }} />
		</article>
	</article>
</RevisedLayout>
